<div class="p-fluid">
  <h3 class="mb-3">Consumos del teléfono {{ phone?.numero }}</h3>

  <!-- Selector de año -->
  <div class="flex align-items-center gap-3 mb-4">
    <label for="anio" class="font-medium">Año:</label>
    <p-select
        [options]="yearOptions"
        [(ngModel)]="selectedYear"
        optionLabel="label"
        optionValue="value"
        placeholder="Selecciona un año"
        (onChange)="onYearChange()"
        styleClass="w-48"
    ></p-select>
  </div>

  <div *ngIf="errorMsg" class="text-red-600 p-2">{{ errorMsg }}</div>

  
  <!-- Tabla de consumos -->
  <p-table *ngIf="consumptions.length > 0"
    [value]="consumptions"
    [loading]="loading"
    [rows]="12"
    [paginator]="false"
    [tableStyle]="{ 'min-width': '30rem' }"
    dataKey="id"
  >
    <ng-template pTemplate="header">
      <tr>
        <th>Mes</th>
        <th>Consumo</th>
        <th style="width: 8rem">Acciones</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-item>
      <tr>
        <td>{{ item.mes }}</td>
        <td>{{ item.consumo }} GB</td>
        <td class="flex gap-2">
          <p-button
            icon="pi pi-pencil"
            severity="success"
            rounded
            size="small"
            (onClick)="onEdit(item)"
          ></p-button>
          <p-button
            icon="pi pi-trash"
            severity="danger"
            rounded
            size="small"
            (onClick)="onDelete(item)"
          ></p-button>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="3" class="text-center text-gray-500 py-3">
          No hay consumos registrados para este año.
        </td>
      </tr>
    </ng-template>
  </p-table>

    <div *ngIf="!consumptions.length && !errorMsg" class="text-gray-500">
        Selecciona un año para ver los consumos.
    </div>

  <!-- Botón añadir consumo -->
  <div class="mt-4 text-right">
    <p-button
      icon="pi pi-plus"
      label="Añadir consumo"
      severity="info"
      (onClick)="onAdd()"
    ></p-button>
  </div>
</div>
